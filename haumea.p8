pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--haumea
--pandora

music(0)
title=true

function _init()
	game_over=false
	win=false
	g=0.035 --gravity		
	make_player()
	make_ground()
end

function _update()
	if (not game_over) and (not title) then
		move_player()
		check_land()
	elseif (btn(4) or btn(5)) then
		game_over=false
		win=false
		reseta()
	end
end

function _draw()
	cls()
	if(title) then
		title_screen()
	else
		draw_stars()
		draw_ground()
		draw_player()
		end_message()
	end
end
-->8
--player

function make_player()
	p={}
	p.x=60	--position
	p.y=7
	p.dx=0---movement
	p.dy=0
	p.sprite=1
	p.alive=true
	p.thrust=0.075
end

function draw_player()
	spr(p.sprite,p.x,p.y)
	if(game_over and win) then
		spr(4,p.x,p.y-8) --flag
	elseif(game_over)then
		spr(5,p.x,p.y) --explode
	end
end

function move_player()
	p.dy+=g
	thrust()
	p.x+=p.dx --moving
	p.y+=p.dy	--player
	stay_on_screen()
end

function thrust()
	--add thrust to movement
	if (btn(0)) then p.dx-=p.thrust end
	if	(btn(1)) then p.dx+=p.thrust	end
	if	(btn(2))	then p.dy-=p.thrust	end
	
	--thrust sound
	if (btn(0) or btn(1) or btn(2)) then sfx(0) end
end

function stay_on_screen()
	if (p.x<0) then	--left side
		p.x=0
		p.dx=0
	end
	if (p.x>119) then --right side
		p.x=119
		p.dx=0
	end
	if (p.y<0) then	--top side
		p.y=0
		p.dy=0
	end
end
-->8
--map
function rndb(low,high)
	return flr(rnd(high-low+1)+low)
end

function draw_stars()
	cls(2)
	srand(2)
	for i=1,50 do
		pset(rndb(0,127),rndb(0,127),rndb(5,7))
	end
	srand(time())
end

function make_ground()
	--create the ground
	gnd={}
	local top=90 --highest point
	local btm=120 --lowest point
	
	--set up landing pad
	pad={}
	pad.width=15
	pad.x=rndb(0,126-pad.width)
	pad.y=rnd(116)+12
	pad.sprite=2
	
	--create ground at pad
	for i=pad.x,pad.x+pad.width do
		gnd[i]=pad.y
	end
	
	--create ground right of pad
	for i=pad.x+pad.width+1,127 do
		local h=rndb(gnd[i-1]-3,gnd[i-1]+3)
		gnd[i]=mid(pad.y,h,btm)
	end
	
	--create ground at left
	for i=pad.x-1,0,-1 do
		local h=rndb(gnd[i+1]-3,gnd[i+1]+3)
		gnd[i]=mid(pad.y,h,btm)
	end
end

function draw_ground()
	for i=0,127 do
		line(i,gnd[i],i,127,13)
	end
	spr(pad.sprite,pad.x,pad.y,2,1)
end

function check_land()
	l_x=flr(p.x)	--ship's l side
	r_x=flr(p.x+7) --ship's r side
	b_y=flr(p.y+7) --ship's bottom

	over_pad=l_x>=pad.x and r_x<=pad.x+pad.width
	on_pad=b_y>=pad.y-1
	slow=p.dy<1
	
	if(over_pad and on_pad and slow) then
		end_game(true)
	elseif(over_pad and on_pad)then
		end_game(false)
	else
		for i=l_x,r_x do
			if (gnd[i]<=b_y) end_game(false)
		end
	end
end
-->8
--game_end

function end_game(won)
	game_over=true
	win=won
	if (win) then
		sfx(6)
	else
		sfx(7)
	end
end

function end_message()
	if(game_over)then
		if (win) then
			print("a winner is you",40,48,11)
		else
			print("shame on you and your space cow",4,48,8)
			palt(0,false)
			palt(11,true)
			spr(6,70,70,4,4)
			palt(11,false)
			palt(0,true)
		end
		print("press ‚ùé or üÖæÔ∏è to reset",20,60,12)
	end
end

function reseta()
	p={}
	gnd={}
	_init()
end
-->8
--start screen
function title_screen()
	cls(0)
	print("press ‚ùé to start",30,120)
		print("code: pandora",60,90)
	print("music: beethoven",60,100)
	sspr(81,0,16,16,50,50,32,32)
	game_name()
	if (btn(5)) then
		title=false
	end
end

function game_name()
	--colors
	for col = 1,7,1 do
		--letters
		for i=1,6 do
			-- t() = time
			t1 = t()*30 + i*4 - col*2
			-- position
			x = 30+i*10
			y = 20+(col-7)+cos(t1/50)*5
			pal(7,col)
			spr(63+i, x, y)
		end
 end	
end
__gfx__
0000000000000000699999aaaaaaaaa60000000080888808bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000066666666666666660000000008999980bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000666666000000000000000000000000000000000000
0070070000cc770001111111111111100000b600899aa998bbbb0000bbbbbbbbbbbbbbbbb000bbbb000006766666660000000000000000000000000000000000
0007700000c777000000000000000000000bb60089aaaa98bbbb0550bbbbbbbbbbbbbbbbb050bbbb000066666666666000000000000000000000000000000000
0007700006cccc60000000000000000000bbb60089aaaa98bbbb055000bbbbbbbbbbbbbbb050bbbb000676666666665000000000000000000000000000000000
0070070066666666000000000000000000000600899aa998bbbb055550bbbbbbbbbbbbbb0050bbbb006666666666655000000000000000000000000000000000
000000000066660000000000000000000000060008999980bbbb055550000000000000005550bbbb006666666666555000000000000000000000000000000000
000000000000000000000000000000000000060080888808bbbb055555577770000000055550bbbb006676666665555000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb000055777770000000055550bbbb066666666655555000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbb0007777770000000055500bbbb066666665555555000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbb0000777777777700000005000bbbb066666555555550000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbb0777777777777770000000000bbbb066555555555500000000000000000000000000000000000
000000000000000000000000000000000000000000000000bb007777777007777777770077700bbb055555555550000000000000000000000000000000000000
000000000000000000000000000000000000000000000000b0077777770707777777777777770bbb005555555000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000b0777770770007777777777777770bbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000b0777770770007777000070007770bbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bb077700777777777777700b00000bbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bb000007777777777777000bbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb000777777777777000bbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb0fffffff77777ff00bbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb0ffffffffffffff00bbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb0fffffffffffffff0bbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb0ffff00ffff00fff0bbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbb00ffff0ffff0fff00bbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbb00ffffffffffff00bbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbb00fffffffff000bbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbbb00000000000bbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
07700770077777700770077007000070077777700777777000000000000000000000000000000000000000000000000000000000000000000000000000000000
07700770077777700770077007700770077000000777777000000000000000000000000000000000000000000000000000000000000000000000000000000000
07700770070000700770077007777770077000000700007000000000000000000000000000000000000000000000000000000000000000000000000000000000
07700770070000700770077007777770077770000700007000000000000000000000000000000000000000000000000000000000000000000000000000000000
07777770077777700770077007777770077770000777777000000000000000000000000000000000000000000000000000000000000000000000000000000000
07777770077777700770077007077070077000000777777000000000000000000000000000000000000000000000000000000000000000000000000000000000
07700770070000700770077007000070077000000700007000000000000000000000000000000000000000000000000000000000000000000000000000000000
07700770070000700777777007000070077777700700007000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000600000362000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
013200000d1500d1500d1500d1500d1500d1500d1500d1500d1500d1500d1500d1500b1500b1500b1500b1500b1500b1500b1500b1500b1500b1500b1500b1500915009150091500915009150091500615006150
0132000014155191551c15514155191551c15514155191551c15514155191551c15514155191551c15514155191551c15514155191551c15514155191551c15515150191501c15015150191501c150151501a150
013200001e150151501a1501e15014150181501e15014150191501c15014150191501b15012155181551b155191001c10014100191001b10012100181001b1000000000000000000000000000000000000000000
013200000615506154061500615008150081500815008150081550815508154081540815008150081500815008100081000810008100081000810008100081000810008100081000810008100081000000000000
000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000d000021050200201b0501a0201605015020200501f02000000170501a0501a0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0004000039660346502f6402c6402864024630206301e6301b62017620156201361011610106100e6100a61006610056100361001610006100061000000000000000000000000000000000000000000000000000
__music__
01 01024344
02 04034344

