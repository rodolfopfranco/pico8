pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--sacred diver
--by pandora
hiscore=0
function _init()
	game_over=false
	game_start=false
	make_player()
	make_cave()
end

function _update()
	if (game_start==true) then
		if (not game_over) then
			update_cave()
			move_player()
			check_hit()
		end
	else
		title_screen()
	end
end

function _draw()
	if (game_start) then
		cls(1)
		draw_cave()
		draw_player()
		check_over()
	end
end

function title_screen()
	if(btn(4) or btn(5)) then
		_init()
		game_start=true
		music(0)
	end
	cls(0)
	sspr(80,0,32,32,35,30,64,64)
	print("press z or x to start",30,100)
	print("⬆️ jump",50,110)
end

function hs()
	if (player.score>hiscore) then
		hiscore=player.score
	end
end

function check_over()
	--manages ending and restart
	if (game_over) then
		print("rock is dead!!",50,50,7)
		print("your score:"..player.score,50,60,7)
		print("press z or x to restart",30,70,7)
		hs()
		if (btn(4) or btn(5)) then
			title_screen()
		end
	else
		print("score:"..player.score,2,2,7)
		print("hi-score:"..hiscore,70,2,7)
	end
end
-->8
--player

function make_player()
	player={}
	player.x=24 --position
	player.y=60
	player.d=0  --fall speed
	player.rise=8 -- sprite
	player.fall=6
	player.dead=3
	player.speed=4 --fly speed
	player.score=0
	player.hiscore=0
end

function draw_player()
	if (game_over) then
		spr(player.dead,player.x,player.y,2,2)
	elseif (player.d<0) then
		spr(player.rise,player.x,player.y,2,2)
	else
		spr(player.fall,player.x,player.y,2,2)
	end
	stay_on_screen()
end

function move_player()
	gravity=0.2 --bigger = more g
	player.d+=gravity
	
	--jump
	if (btnp(2)) then	
		player.d-=4
		sfx(3)
	end
	
	--move
	player.y+=player.d
	
	if (btn(0)) then
		player.x-=1
	end
	
	if (btn(1)) then
		player.x+=1
	end
	
	--score
	player.score+=player.speed
	difficulty()
end

function check_hit()
	for i=player.x,player.x+7 do
		if (cave[i+1].top>player.y
			or cave[i+1].btm<player.y+7) then
				game_over=true
				music(-1)
				sfx(2)
		end
	end
end

function difficulty()
--increases speed every 1000 after 3000
	if (player.score>3000) then
		player.speed=flr(player.score/1000)+2
	end
end

function stay_on_screen()
	if (player.x<1) then	--left side
		player.x=1
	end
	if (player.x>111) then --right side
		player.x=111
	end
end
-->8
--cave

function make_cave()
	cave={{["top"]=5,["btm"]=119,["lft"]=5,["rgt"]=119}}
	top=60 --how low ceiling go
	btm=100 --how high floor get
	lft=50
	rgt=90
end

function update_cave()
--remove back
	if (#cave>player.speed) then
		for i=1,player.speed do
			del(cave,cave[1])
		end
	end
--add front
	while (#cave<128) do
		local col={}
		local up=flr(rnd(7)-3)
		local dwn=flr(rnd(7)-3)
		col.top=mid(3,cave[#cave].top+up,top)
		col.btm=mid(btm,cave[#cave].btm+dwn,124)
		add(cave,col)
	end
end

function draw_cave()
	top_color=9
	btm_color=9
	for i=1,#cave do
		line(i-1,0,i-1,cave[i].top,top_color)
		line(i-1,127,i-1,cave[i].btm,btm_color)
	end
end
__gfx__
00000000000000000000000000000000000000000000000000000200002000000000020000200000000000000000000000000000000000000000000000000000
00000000222222220200002002000020000000000000000000000222222000000000022222200000000000000000000000000000000000000000000000000000
00700700028228200222222002222220000000000000000000000282282000000000028228200000088808888088088880880880000000000000000000000000
00077000009229000222222002222220000000000000000000000092290000000000009229000000080008008080080080800808000000000000000000000000
00077000002222000092290000822800000000000000000002220022220022200000002222000000080008008080080080800800800000000000000000000000
00700700002222000082280000222200000000000000000000020022220020000000002222000000088808088080088880880800800000000000000000000000
00000000000220000022220000288200000000000000000000022252252220000002225225222000000808888080088000800800800000000000000000000000
00000000000000000002200000022000000000000000000000005555555500000020555555550200000808008080080800800800800000000000000000000000
00000000000000000000000000000000000000000000000000005558855500000220555885550220088808008088080080880888000000000000000000000000
00000000000000000000000000000000000000000000000000002055550200002200205555020022000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000002055550200000000205555020000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000020020000000000002002000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000020020000000000002002000000000000000088000808000808808888000000000000000000
00000000000000000000000000000000000000000000000000000200002000000000020000200000000000000080800808008808008008000000000000000000
00000000000000000000000000000000000000000000000000000200002000000000020000200000000000000080080808008008008008000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080080808088008808888000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080080808880008008880000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080080808800008008088000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000088800808800008808008000000000000000000
__label__
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999911999111119911111999911199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999919111999111119111111991911199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999111111199111119111111111911199999999999999999999999999999999999999999919999999999999999999999999999999999999999999999999
99999999111111111111111111111111111119999999999999999999999999999999999999999919199199999999999999999999999999999999999999999911
91999191111111111111111111111111111119999999999999999999999999999999999999999111199199999999999999999999999999999999999999991911
91919191111111111111111111111111111119999999999999999999999999999999999999991111191199999999999999999999999999999999999991911111
91119191111111111111111111111111111111199999999199999999999999999999999999991111111119999999999999999999999999999999999991111111
11111111111111111111111111111111111111199999999199999999999991199999999999911111111111999999999999999999999999999999999911111111
11111111111111111111111111111111111111119999991119991991999911199999911991111111111111199999999999999999999999999999999911111111
11111111111111111111111111111111111111119999911119911991199911199999111911111111111111199999999999991999199999999999999111111111
11111111111111111111111111111111111111111999911111111111111111119991111111111111111111199999999119911991199999999999999111111111
11111111111111111111111111111111111111111919111111111111111111119191111111111111111111111999999119911991119999999919991111111111
11111111111111111111111111111111111111111119111111111111111111111191111111111111111111111991999111111191119999999919991111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111191991111111111111919999911911111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111191111111111111111911999111911111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111991111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111991111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111818818111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111218812111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111222222111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111222222111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111192291111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111122221111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111122221111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111112211111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111191111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111191111191111111911111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111191111191111111911111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111991111999119119911111191111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111999111999119119991111191111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
19111111999111999999199999111991111111111111191111111111111111111111111111111111111111111111111111111111111111111111111111111111
99111119999999999999999999111999111911111111191111111111111111111111111111111111111111111111111111111111111111111111111111111111
99111119999999999999999999919999111991111111191191911111111111111111111111111111111111111111111111111111111111111111111111111111
99999199999999999999999999999999111991111119999991911111111111111111111111111111111111111111111111111111111111111111111111111111
99999999999999999999999999999999999991191119999991911111111111111111111111111111111111111111111111111111111111111111111111111111
99999999999999999999999999999999999999199199999999991111111111111111111111111111111111111111111111111111111111111111111111111111
99999999999999999999999999999999999999999199999999991111111111111111111111111111111111111111111111111111111111111111111111111111
99999999999999999999999999999999999999999199999999999111111111111111111111111111111111111111111111111111191111111111111111111111
99999999999999999999999999999999999999999999999999999911111111111911111111111111111111111111111111111111999111911111111111111111
99999999999999999999999999999999999999999999999999999911111111111911111111111111111111111111111111111911999111911111111111111111
99999999999999999999999999999999999999999999999999999911111111119911111111111111111111111111111111111911999199991111111111111111
99999999999999999999999999999999999999999999999999999991111111119991111111111111111111111111111111911999999999991111111111111111
99999999999999999999999999999999999999999999999999999999111111199991111111111111111111111111119911919999999999991111111111111111
99999999999999999999999999999999999999999999999999999999191111199991111111111111111111111111119919919999999999999111111111111191
99999999999999999999999999999999999999999999999999999999991191999999111111111111111111111111119999999999999999999111111111111991
99999999999999999999999999999999999999999999999999999999999991999999111111111111111111111111199999999999999999999911111111119991
99999999999999999999999999999999999999999999999999999999999991999999111111911111111111111119199999999999999999999919111911119999
99999999999999999999999999999999999999999999999999999999999999999999911111999111911111111119199999999999999999999999911911119999
99999999999999999999999999999999999999999999999999999999999999999999911199999111911111111119999999999999999999999999991991199999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999

__sfx__
001401010c0500c0000c0500c0500c050020000c0500c0500c0500e0000e0500f0000f0500000000000000000c050000000c0500c0500c050000000c0500e0500f050000000a000270000a050000000000000000
001400000c050000000c0500c0500c050000000c0500e0500f0500000000000000000a0500000000000000000c05000000000000a05000000000000c050000000000000000000000000000000000000000000000
000800000000019550000001455000000000000e55000000000000855008550085500855008550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00020000085500b55012550165501655015550135500a550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 00414344
02 01424344

